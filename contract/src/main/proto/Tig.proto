syntax = "proto3";
package tig.grpc.contract;
import "google/protobuf/empty.proto";


service TigService {
  rpc login(LoginRequest) returns (LoginReply);
  rpc logout(SessionRequest) returns (google.protobuf.Empty);
  rpc uploadFile(stream FileChunk) returns (StatusReply);
  rpc editFile(stream FileChunk) returns (StatusReply);
  rpc deleteFile(FileRequest) returns (StatusReply);
  rpc accessControlFile(OperationRequest) returns (StatusReply);
  rpc listFiles(SessionRequest) returns (ListFilesReply);
}

// LOGIN OPERATION
message LoginRequest {
  string username = 1;
  string password = 2;
}

message LoginReply {
  LoginStatus response = 1;
  string sessionId = 2;
}

enum LoginStatus {
  SUCCESS = 0;
  FAIL = 1;
}
message SessionRequest {
  string sessionId = 1;
}

// FILE STREAM OPERATION
message FileChunk {
  bytes content = 1;
  string sessionId = 2;
  string fileName = 3;
}

message StatusReply {
  StatusCode Code = 1;
}

enum StatusCode {
  UNKNOWN = 0;
  OK = 1;
  FAILED = 2;
}

//FILE OPERATION
message FileRequest {
  string sessionId = 1;
  string fileName = 2;
}

//ACCESS CONTROL OPERATION
message OperationRequest {
  string sessionId = 1;
  string fileName = 2;
  OperationEnum operation = 3;
}

enum OperationEnum {
  PUBLIC = 0;
  PRIVATE = 1;
}

//LIST FILES
message ListFilesReply {
  repeated string fileNames = 1;
}